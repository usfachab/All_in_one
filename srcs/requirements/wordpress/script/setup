#!/bin/sh
set -e

adduser -S -D -H -G www-data www-data

wp core download --path=/var/www/wordpress --force

wp config create --dbname=$DB_NAME --dbuser=$DB_USER --dbpass=$DB_PASSWORD \
				--dbhost=$DB_HOST --dbprefix=utf8 --force

wp core install \
    --url="$URL" \
    --title="$TITLE" \
    --admin_user="$ADMIN_USER" \
    --admin_password="$ADMIN_PASSWORD" \
    --admin_email="$ADMIN_EMAIL" \
    --skip-email

chown -R www-data:www-data /var/www/

find /var/www/ -type d -exec chmod 755 {} \;

find /var/www/ -type f -exec chmod 644 {} \;

exec $@
